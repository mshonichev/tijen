---
- scm:
    name: tiden
    scm:
      - git:
          url: https://github.com/ggprivate/tiden.git
          branches:
            - '*/master'
          credentials-id: mshonichev
          timeout: 20
          basedir: tiden
- scm:
    name: tijen
    scm:
      - git:
          url: https://github.com/mshonichev/tijen.git
          branches:
            - '*/master'
          credentials-id: mshonichev
          timeout: 20
          basedir: tijen
- scm:
    name: tiden-and-tijen
    scm:
      - tiden
      - tijen
- job:
    name: Release
    project-type: folder
- job:
    name: Release/Util
    project-type: folder
- job:
    name: Release/Util/util-create-ignite-release-tasks
    description: 'This job generates Jenkins tasks for Apache Ignite release\n'
    display-name: '[util] Create AI release tasks'
    scm:
      - tijen
    parameters:
      - string:
          name: IGNITE_VERSION
          default: 2.5.1-p8
          description: "Apache Ignite version, e.g. 2.5.1"
    builders:
     - shell: |
         cd tijen
         export PYTHONPATH=$PYTHONPATH:$(readlink -f ../tiden)
         python3 prepare-gg-release-tasks.py --var_dir var --res_dir res/ai || exit 1
         jenkins-jobs --conf create_seed/jenkins.ini update var || exit 2
#    - shell: |
#        cd tiden
#        utils/prepare_work_dir.sh
#    - shell: |
#        pwd
#        ls -1 tiden/suites
#        python3 run-tests.py --help
- job:
    name: Release/Util/util-create-gridgain-release-tasks
    description: 'This job generates Jenkins tasks for GridGain Ultimate Edition release
    '
    display-name: '[util] Create GG UE release tasks'
    scm:
      - tijen
    parameters:
      - string:
          name: IGNITE_VERSION
          default: 2.5.1-p8
          description: "Apache Ignite version, e.g. 2.5.1"
      - string:
          name: GRIDGAIN_VERSION
          default: 8.5.1-p8
          description: "GridGain version, e.g. 8.5.1"
  wrappers:
    - ansicolor:
    - timestamp:
  builders:
     - shell: |
         cd tijen
         export PYTHONPATH=$PYTHONPATH:$(readlink -f ../tiden)
         python3 prepare-gg-release-tasks.py --var_dir var --res_dir res/gg-ult-fab || exit 1
         jenkins-jobs --conf create_seed/jenkins.ini update var || exit 2

#    - shell: |
#        cd tiden
#        bash utils/prepare_work_dir.sh
#    - shell: |
#        pwd
#        ls -1 tiden/suites
#        python3 run-tests.py --help
